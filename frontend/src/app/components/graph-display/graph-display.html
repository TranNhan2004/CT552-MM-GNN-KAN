<div class="bg-white border-2 border-cyan-200 rounded-xl shadow-lg overflow-hidden">
  <div class="bg-gradient-to-r from-green-300 via-cyan-400 to-blue-500 px-6 py-4">
    <h2 class="text-xl font-bold text-white">Đồ thị</h2>
  </div>

  <div class="p-6 relative">
    <!-- Cytoscape container luôn tồn tại -->
    <div #cyContainer
      class="w-full h-[500px] rounded-lg bg-gradient-to-br from-gray-50 to-blue-50 border-2 border-gray-200">
    </div>

    <!-- TOOLTIP: Được đặt trong container relative để định vị tuyệt đối theo đồ thị -->
    <div *ngIf="tooltipInfo.visible" class="cy-tooltip" [style.left.px]="tooltipInfo.x" [style.top.px]="tooltipInfo.y">
      <div class="tooltip-title">{{ tooltipInfo.word }}</div>
      <div class="tooltip-content">{{ tooltipInfo.sentence }}</div>
    </div>

    <!-- Overlay "Chưa có dữ liệu" -->
    @if (!result) {
    <div
      class="absolute inset-0 flex flex-col items-center justify-center bg-gradient-to-br from-gray-50 to-blue-50 rounded-lg z-10 m-6 border-2 border-dashed border-gray-300">
      <div class="bg-gradient-to-br from-green-100 to-blue-100 rounded-full p-6 mb-4 shadow-sm">
        <svg class="w-16 h-16 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
        </svg>
      </div>
      <p class="text-gray-500 text-center text-lg font-medium">Chưa có dữ liệu</p>
      <p class="text-gray-400 text-center text-sm mt-2">Vui lòng thực hiện dự đoán để xem đồ thị</p>
    </div>
    }

    <!-- Overlay "Chưa chọn nút" -->
    @if (result && (!selectionData || (selectionData.imageIndices.length===0 && selectionData.textIndices.length===0 &&
    selectionData.audioIndices.length===0))) {
    <div
      class="absolute inset-0 flex flex-col items-center justify-center bg-white/80 backdrop-blur-sm rounded-lg z-10 m-6 border border-gray-100">
      <div class="bg-gradient-to-br from-green-100 to-blue-100 rounded-full p-6 mb-4 shadow-sm">
        <svg class="w-16 h-16 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4" />
        </svg>
      </div>
      <p class="text-gray-600 text-center text-lg font-medium">Chưa chọn nút nào</p>
      <p class="text-gray-500 text-center text-sm mt-2">Mở "Danh sách nút" để chọn các nút hiển thị</p>
    </div>
    }

    <!-- Legend (Placeholder demo) -->
    <div class="absolute top-8 right-8 bg-white/90 p-2 rounded shadow-sm text-xs border border-gray-100 z-0">
      <div class="flex items-center gap-2 mb-1"><span class="w-3 h-3 bg-cyan-400 rounded-full"></span> Text</div>
      <div class="flex items-center gap-2 mb-1"><span class="w-3 h-3 bg-blue-500 rounded"></span> Audio</div>
      <div class="flex items-center gap-2"><span class="w-3 h-3 border border-gray-300 bg-white"></span> Image</div>
    </div>

    <!-- Controls (Placeholder demo) -->
    <div class="absolute bottom-8 left-8 flex gap-2 z-0">
      <button (click)="cyVal?.fit()"
        class="bg-white hover:bg-gray-100 text-gray-700 p-2 rounded shadow border border-gray-200 transition-colors"
        title="Fit Graph">
        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2"
            d="M4 8V4m0 0h4M4 4l5 5m11-1V4m0 0h-4m4 0l-5 5M4 16v4m0 0h4m-4 0l5-5m11 5l-5-5m5 5v-4m0 4h-4" />
        </svg>
      </button>
    </div>
  </div>
</div>
